---
layout: post
title: "ALS学习"
date: 2025-05-22
categories: UE源码学习
excerpt: 总结一下在ALS中遇到的问题和需要注意的点
author: Tizeng
---

* content
{:toc}

## 输入相关

使用EnhanceInput时，将对应的IMC作为参数调用AddMappingContext后，还需要为每个IA注册对应的方法，在蓝图中可以直接输入IA的名字拿到其处理回调的节点，若要在C++中注册，则需要有地方去配置每个IA，lyra的做法是写一个结构，其中每个IA都对应一个Tag，代码中根据Tag来遍历区分对应的回调函数，具体逻辑在`LyraHeroComponent.cpp`中。

要实现一个简单的鼠标控制镜头和人物移动，人物自动转向移动的方向，除了正确的处理输入外，还需要配置以下内容：

* 角色蓝图中不勾选`UseControllerRotationYaw`
* SpringArm中勾选`UsePawnControlRatation`
* 移动组件中勾选`OrientRotationToMovement`（此项在加入八方向移动时需要去掉，因为我们要自己控制角色的旋转，以更好的匹配动画）

## 速度匹配

在获取速度和加速度进行计算时，不要忘了考虑角色的朝向，计算前需要将其与角色对齐，拿到角色的rot后进行一次Unrotate即可。
